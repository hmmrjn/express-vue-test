'use strict';

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

// vue: {
//     head: {
//         title: 'Page Title',
//         meta: [
//             { property:'og:title', content: 'Page Title'},
//             { name:'twitter:title', content: 'Page Title'},
//         ]
//     }
// }
var HeadUtil = function () {
    function HeadUtil(vueObject, styleString) {
        _classCallCheck(this, HeadUtil);

        this.setupStyleString(styleString);
        this.setupMetaTags(vueObject);
        this.setupTitle(vueObject);
        this.setupStructuredData(vueObject);
    }

    _createClass(HeadUtil, [{
        key: 'setupMetaTags',
        value: function setupMetaTags(vueObject) {
            if (this.metaTags === undefined) {
                this.metaTags = '';
            }
            if (vueObject.head && vueObject.head.meta) {
                var _iteratorNormalCompletion = true;
                var _didIteratorError = false;
                var _iteratorError = undefined;

                try {
                    for (var _iterator = vueObject.head.meta[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                        var metaItem = _step.value;

                        if (metaItem.value) {
                            this.metaTags += '<meta name="' + metaItem.name + '" value="' + metaItem.value + '"/>\n';
                        } else if (metaItem.name) {
                            this.metaTags += '<meta name="' + metaItem.name + '" content="' + metaItem.content + '"/>\n';
                        } else if (metaItem.property) {
                            this.metaTags += '<meta property="' + metaItem.property + '" content="' + metaItem.content + '"/>\n';
                        } else if (metaItem.script) {
                            var charset = metaItem.charset || 'utf-8';
                            var async = metaItem.async ? ' async=true' : '';
                            this.metaTags += '<script src="' + metaItem.script + '" charset="' + charset + '"' + async + '></script>\n';
                        } else if (metaItem.charset) {
                            this.metaTags += '<meta charset="' + metaItem.charset + '"/>\n';
                        } else if (metaItem.style) {
                            var type = metaItem.type || 'text/css';
                            var rel = 'stylesheet';
                            this.metaTags += '<link rel="' + rel + '" type="' + type + '" href="' + metaItem.style + '">\n';
                        } else if (metaItem.rel) {
                            // <link rel="icon" type="image/png" href="/assets/favicons/favicon-32x32.png" sizes="32x32"/>
                            var _rel = metaItem.rel ? 'rel="' + metaItem.rel + '" ' : '';
                            var _type = metaItem.type ? 'type="' + metaItem.type + '" ' : '';
                            var href = metaItem.href ? 'href="' + metaItem.href + '" ' : '';
                            var sizes = metaItem.sizes ? 'sizes="' + metaItem.sizes + '" ' : '';
                            var itemprop = metaItem.itemprop ? 'itemprop="' + metaItem.itemprop + '" ' : '';
                            var hreflang = metaItem.hreflang ? 'hreflang="' + metaItem.hreflang + '" ' : '';
                            var crossorigin = metaItem.crossorigin ? 'crossorigin="' + metaItem.crossorigin + '"' : '';
                            this.metaTags += '<link ' + _rel + _type + href + sizes + itemprop + hreflang + crossorigin + '>\n';
                        } else if (metaItem.srcContents) {
                            this.metaTags += metaItem.srcContents + '\n';
                        }
                    }
                } catch (err) {
                    _didIteratorError = true;
                    _iteratorError = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion && _iterator.return) {
                            _iterator.return();
                        }
                    } finally {
                        if (_didIteratorError) {
                            throw _iteratorError;
                        }
                    }
                }
            }
        }
    }, {
        key: 'setupTitle',
        value: function setupTitle(vueObject) {
            if (vueObject && vueObject.head && vueObject.head.title) {
                this.title = '<title>' + vueObject.head.title + '</title>\n';
            } else {
                this.title = '';
            }
        }
    }, {
        key: 'setupStructuredData',
        value: function setupStructuredData(vueObject) {
            if (vueObject && vueObject.head && vueObject.head.structuredData) {
                this.structuredData = '<script type="application/ld+json">\n' + JSON.stringify(vueObject.head.structuredData) + '\n</script>\n';
            } else {
                this.structuredData = '';
            }
        }
    }, {
        key: 'setupStyleString',
        value: function setupStyleString(styleString) {
            if (styleString) {
                this.style = '<style>' + styleString + '</style>';
            } else {
                this.style = '';
            }
        }
    }, {
        key: 'toString',
        value: function toString() {
            return '<head>\n' + this.title + this.metaTags + this.structuredData + this.style + '</head>';
        }
    }]);

    return HeadUtil;
}();

module.exports = HeadUtil;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9oZWFkLmpzIl0sIm5hbWVzIjpbIkhlYWRVdGlsIiwidnVlT2JqZWN0Iiwic3R5bGVTdHJpbmciLCJzZXR1cFN0eWxlU3RyaW5nIiwic2V0dXBNZXRhVGFncyIsInNldHVwVGl0bGUiLCJzZXR1cFN0cnVjdHVyZWREYXRhIiwibWV0YVRhZ3MiLCJ1bmRlZmluZWQiLCJoZWFkIiwibWV0YSIsIm1ldGFJdGVtIiwidmFsdWUiLCJuYW1lIiwiY29udGVudCIsInByb3BlcnR5Iiwic2NyaXB0IiwiY2hhcnNldCIsImFzeW5jIiwic3R5bGUiLCJ0eXBlIiwicmVsIiwiaHJlZiIsInNpemVzIiwiaXRlbXByb3AiLCJocmVmbGFuZyIsImNyb3Nzb3JpZ2luIiwic3JjQ29udGVudHMiLCJ0aXRsZSIsInN0cnVjdHVyZWREYXRhIiwiSlNPTiIsInN0cmluZ2lmeSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQVNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtJQUNNQSxRO0FBS0Ysc0JBQVlDLFNBQVosRUFBc0NDLFdBQXRDLEVBQTJEO0FBQUE7O0FBQ3ZELGFBQUtDLGdCQUFMLENBQXNCRCxXQUF0QjtBQUNBLGFBQUtFLGFBQUwsQ0FBbUJILFNBQW5CO0FBQ0EsYUFBS0ksVUFBTCxDQUFnQkosU0FBaEI7QUFDQSxhQUFLSyxtQkFBTCxDQUF5QkwsU0FBekI7QUFDSDs7OztzQ0FDYUEsUyxFQUFtQjtBQUM3QixnQkFBSSxLQUFLTSxRQUFMLEtBQWtCQyxTQUF0QixFQUFpQztBQUM3QixxQkFBS0QsUUFBTCxHQUFnQixFQUFoQjtBQUNIO0FBQ0QsZ0JBQUlOLFVBQVVRLElBQVYsSUFBa0JSLFVBQVVRLElBQVYsQ0FBZUMsSUFBckMsRUFBMkM7QUFBQTtBQUFBO0FBQUE7O0FBQUE7QUFDdkMseUNBQXFCVCxVQUFVUSxJQUFWLENBQWVDLElBQXBDLDhIQUEwQztBQUFBLDRCQUFqQ0MsUUFB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QVVRLElBQVYsQ0FBZW9CLGNBQTlCLENBQTlEO0FBQ0gsYUFGRCxNQUVPO0FBQ0gscUJBQUtBLGNBQUwsR0FBc0IsRUFBdEI7QUFDSDtBQUNKOzs7eUNBQ2dCM0IsVyxFQUFxQjtBQUNsQyxnQkFBSUEsV0FBSixFQUFpQjtBQUNiLHFCQUFLaUIsS0FBTCxlQUF1QmpCLFdBQXZCO0FBQ0gsYUFGRCxNQUVPO0FBQ0gscUJBQUtpQixLQUFMLEdBQWEsRUFBYjtBQUNIO0FBQ0o7OzttQ0FDa0I7QUFDZixtQkFBTyxhQUFhLEtBQUtTLEtBQWxCLEdBQTBCLEtBQUtyQixRQUEvQixHQUEwQyxLQUFLc0IsY0FBL0MsR0FBZ0UsS0FBS1YsS0FBckUsR0FBNkUsU0FBcEY7QUFDSDs7Ozs7O0FBR0xhLE9BQU9DLE9BQVAsR0FBaUJqQyxRQUFqQiIsImZpbGUiOiJoZWFkLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQGZsb3dcblxudHlwZSBWdWVPYmplY3RUeXBlID0ge1xuICAgIGhlYWQ6IHtcbiAgICAgICAgdGl0bGU6IHN0cmluZyxcbiAgICAgICAgbWV0YTogT2JqZWN0W10sXG4gICAgICAgIHN0cnVjdHVyZWREYXRhOiBPYmplY3RcbiAgICB9XG59XG4vLyB2dWU6IHtcbi8vICAgICBoZWFkOiB7XG4vLyAgICAgICAgIHRpdGxlOiAnUGFnZSBUaXRsZScsXG4vLyAgICAgICAgIG1ldGE6IFtcbi8vICAgICAgICAgICAgIHsgcHJvcGVydHk6J29nOnRpdGxlJywgY29udGVudDogJ1BhZ2UgVGl0bGUnfSxcbi8vICAgICAgICAgICAgIHsgbmFtZTondHdpdHRlcjp0aXRsZScsIGNvbnRlbnQ6ICdQYWdlIFRpdGxlJ30sXG4vLyAgICAgICAgIF1cbi8vICAgICB9XG4vLyB9XG5jbGFzcyBIZWFkVXRpbCB7XG4gICAgbWV0YVRhZ3M6IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIHN0cnVjdHVyZWREYXRhOiBzdHJpbmc7XG4gICAgc3R5bGU6IHN0cmluZztcbiAgICBjb25zdHJ1Y3Rvcih2dWVPYmplY3Q6IFZ1ZU9iamVjdFR5cGUsIHN0eWxlU3RyaW5nOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5zZXR1cFN0eWxlU3RyaW5nKHN0eWxlU3RyaW5nKTtcbiAgICAgICAgdGhpcy5zZXR1cE1ldGFUYWdzKHZ1ZU9iamVjdCk7XG4gICAgICAgIHRoaXMuc2V0dXBUaXRsZSh2dWVPYmplY3QpO1xuICAgICAgICB0aGlzLnNldHVwU3RydWN0dXJlZERhdGEodnVlT2JqZWN0KTtcbiAgICB9XG4gICAgc2V0dXBNZXRhVGFncyh2dWVPYmplY3Q6IE9iamVjdCkge1xuICAgICAgICBpZiAodGhpcy5tZXRhVGFncyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLm1ldGFUYWdzID0gJyc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHZ1ZU9iamVjdC5oZWFkICYmIHZ1ZU9iamVjdC5oZWFkLm1ldGEpIHtcbiAgICAgICAgICAgIGZvciAobGV0IG1ldGFJdGVtIG9mIHZ1ZU9iamVjdC5oZWFkLm1ldGEpIHtcbiAgICAgICAgICAgICAgICBpZiAobWV0YUl0ZW0udmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXRhVGFncyArPSBgPG1ldGEgbmFtZT1cIiR7bWV0YUl0ZW0ubmFtZX1cIiB2YWx1ZT1cIiR7bWV0YUl0ZW0udmFsdWV9XCIvPlxcbmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXRhSXRlbS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWV0YVRhZ3MgKz0gYDxtZXRhIG5hbWU9XCIke21ldGFJdGVtLm5hbWV9XCIgY29udGVudD1cIiR7bWV0YUl0ZW0uY29udGVudH1cIi8+XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1ldGFJdGVtLnByb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWV0YVRhZ3MgKz0gYDxtZXRhIHByb3BlcnR5PVwiJHttZXRhSXRlbS5wcm9wZXJ0eX1cIiBjb250ZW50PVwiJHttZXRhSXRlbS5jb250ZW50fVwiLz5cXG5gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWV0YUl0ZW0uc2NyaXB0KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXJzZXQgPSBtZXRhSXRlbS5jaGFyc2V0IHx8ICd1dGYtOCc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGFzeW5jID0gbWV0YUl0ZW0uYXN5bmMgPyAnIGFzeW5jPXRydWUnIDogJyc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWV0YVRhZ3MgKz0gYDxzY3JpcHQgc3JjPVwiJHttZXRhSXRlbS5zY3JpcHR9XCIgY2hhcnNldD1cIiR7Y2hhcnNldH1cIiR7YXN5bmN9Pjwvc2NyaXB0PlxcbmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXRhSXRlbS5jaGFyc2V0KSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWV0YVRhZ3MgKz0gYDxtZXRhIGNoYXJzZXQ9XCIke21ldGFJdGVtLmNoYXJzZXR9XCIvPlxcbmA7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtZXRhSXRlbS5zdHlsZSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0eXBlID0gbWV0YUl0ZW0udHlwZSB8fCAndGV4dC9jc3MnO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCByZWwgPSAnc3R5bGVzaGVldCc7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMubWV0YVRhZ3MgKz0gYDxsaW5rIHJlbD1cIiR7cmVsfVwiIHR5cGU9XCIke3R5cGV9XCIgaHJlZj1cIiR7bWV0YUl0ZW0uc3R5bGV9XCI+XFxuYDtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1ldGFJdGVtLnJlbCkge1xuICAgICAgICAgICAgICAgICAgICAvLyA8bGluayByZWw9XCJpY29uXCIgdHlwZT1cImltYWdlL3BuZ1wiIGhyZWY9XCIvYXNzZXRzL2Zhdmljb25zL2Zhdmljb24tMzJ4MzIucG5nXCIgc2l6ZXM9XCIzMngzMlwiLz5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcmVsID0gbWV0YUl0ZW0ucmVsID8gYHJlbD1cIiR7bWV0YUl0ZW0ucmVsfVwiIGAgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdHlwZSA9IG1ldGFJdGVtLnR5cGUgPyBgdHlwZT1cIiR7bWV0YUl0ZW0udHlwZX1cIiBgIDogJyc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGhyZWYgPSBtZXRhSXRlbS5ocmVmID8gYGhyZWY9XCIke21ldGFJdGVtLmhyZWZ9XCIgYCA6ICcnO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzaXplcyA9IG1ldGFJdGVtLnNpemVzID8gYHNpemVzPVwiJHttZXRhSXRlbS5zaXplc31cIiBgIDogJyc7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW1wcm9wID0gbWV0YUl0ZW0uaXRlbXByb3AgPyBgaXRlbXByb3A9XCIke21ldGFJdGVtLml0ZW1wcm9wfVwiIGAgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgaHJlZmxhbmcgPSBtZXRhSXRlbS5ocmVmbGFuZyA/IGBocmVmbGFuZz1cIiR7bWV0YUl0ZW0uaHJlZmxhbmd9XCIgYCA6ICcnO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjcm9zc29yaWdpbiA9IG1ldGFJdGVtLmNyb3Nzb3JpZ2luID8gYGNyb3Nzb3JpZ2luPVwiJHttZXRhSXRlbS5jcm9zc29yaWdpbn1cImAgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXRhVGFncyArPSBgPGxpbmsgJHtyZWx9JHt0eXBlfSR7aHJlZn0ke3NpemVzfSR7aXRlbXByb3B9JHtocmVmbGFuZ30ke2Nyb3Nzb3JpZ2lufT5cXG5gO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWV0YUl0ZW0uc3JjQ29udGVudHMpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5tZXRhVGFncyArPSBgJHttZXRhSXRlbS5zcmNDb250ZW50c31cXG5gO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXR1cFRpdGxlKHZ1ZU9iamVjdDogT2JqZWN0KSB7XG4gICAgICAgIGlmICh2dWVPYmplY3QgJiYgdnVlT2JqZWN0LmhlYWQgJiYgdnVlT2JqZWN0LmhlYWQudGl0bGUpIHtcbiAgICAgICAgICAgIHRoaXMudGl0bGUgPSBgPHRpdGxlPiR7dnVlT2JqZWN0LmhlYWQudGl0bGV9PC90aXRsZT5cXG5gO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZSA9ICcnO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldHVwU3RydWN0dXJlZERhdGEodnVlT2JqZWN0OiBPYmplY3QpIHtcbiAgICAgICAgaWYgKHZ1ZU9iamVjdCAmJiB2dWVPYmplY3QuaGVhZCAmJiB2dWVPYmplY3QuaGVhZC5zdHJ1Y3R1cmVkRGF0YSkge1xuICAgICAgICAgICAgdGhpcy5zdHJ1Y3R1cmVkRGF0YSA9IGA8c2NyaXB0IHR5cGU9XCJhcHBsaWNhdGlvbi9sZCtqc29uXCI+XFxuJHtKU09OLnN0cmluZ2lmeSh2dWVPYmplY3QuaGVhZC5zdHJ1Y3R1cmVkRGF0YSl9XFxuPC9zY3JpcHQ+XFxuYDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3RydWN0dXJlZERhdGEgPSAnJztcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXR1cFN0eWxlU3RyaW5nKHN0eWxlU3RyaW5nOiBzdHJpbmcpIHtcbiAgICAgICAgaWYgKHN0eWxlU3RyaW5nKSB7XG4gICAgICAgICAgICB0aGlzLnN0eWxlID0gYDxzdHlsZT4ke3N0eWxlU3RyaW5nfTwvc3R5bGU+YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3R5bGUgPSAnJztcbiAgICAgICAgfVxuICAgIH1cbiAgICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gJzxoZWFkPlxcbicgKyB0aGlzLnRpdGxlICsgdGhpcy5tZXRhVGFncyArIHRoaXMuc3RydWN0dXJlZERhdGEgKyB0aGlzLnN0eWxlICsgJzwvaGVhZD4nO1xuICAgIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBIZWFkVXRpbDtcbiJdfQ==